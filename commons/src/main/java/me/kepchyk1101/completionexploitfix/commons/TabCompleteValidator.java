package me.kepchyk1101.completionexploitfix.commons;

import lombok.experimental.UtilityClass;
import org.jetbrains.annotations.NotNull;

@UtilityClass
public class TabCompleteValidator {

    /**
     * Checks a string from a tab completion request for a brigadier stack overflow exploit
     * @param request Received string from request
     * @return true - the request is harmless, false - contains an exploit
     */
    public boolean isRequestValid(@NotNull String request) {
        if (request.contains("@")) {
            return false;
        }
        int counter = 0;
        for (char c : request.toCharArray()) {
            if (c == '[') {
                counter++;
            }
        }
        return counter < 100;
    }

}
